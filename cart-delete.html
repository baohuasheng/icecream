<!doctype html>
<html lang="zh-cn">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,Chrome=1">
    <meta name="viewport" content="initial-scale=1, maximum-scale=1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <title>title</title>
    <meta name="keywords" content="">
    <meta name="description" content="">
    <link href="css/style.css" rel="stylesheet">
</head>

<body>
<div class="page-group">
    <header>
        <a href="#" class="right-txt ico pull-right">确定</a>
        <p class="header-title">购物车</p>
    </header>
    <footer>
        <a href="index.html">
            <div class="icon-wrap"><i class="icon-home"></i></div>
            <span>首页</span>
        </a>
        <a href="spread.html">
            <div class="icon-wrap"><i class="icon-extension"></i></div>
            <span>我要推广</span>
        </a>
        <a href="type.html" class="active">
            <div class="icon-wrap"><i class="icon-classification"></i></div>
            <span>分类</span>
        </a>
        <a href="cart.html">
            <div class="icon-wrap"><i class="icon-shopping-cart"></i><span>5</span></div>
            <span>购物车</span>
        </a>
        <a href="me.html">
            <div class="icon-wrap"><i class="icon-me"></i></div>
            <span>我的</span>
        </a>
    </footer>
    <div class="content">
        <div class="cart-list">
            <ul>
                <li>
                    <label class="cart-checkbox-label">
                        <input class="cart-input" data-id="1" type="checkbox" name="checkbox">
                        <i class="icon-no-selected"></i>
                        <i class="icon-selected2"></i>
                    </label>
                    <div class="cart-list-info">
                        <div class="cart-img">
                            <img src="images/commodity.jpg">
                        </div>
                        <div class="cart-list-main">
                            <p class="cart-list-name">[现榨现喝 轻便携带]Midea/...</p>
                            <p class="cart-list-specifications">1L 白色</p>
                            <div class="cart-list-bottom">
                                <p class="cart-list-price">¥<span class="price">54.01</span></p>
                                <div class="popup-cart-number-choice">
                                    <p class="popup-cart-number-choice-btn reduce" data-id="1">－</p>
                                    <input value="5" data-price="54.01"  data-min="4"  data-max="10" readonly class="popup-cart-number-choice-input" id="num_1">
                                    <p class="popup-cart-number-choice-btn plus" data-id="1">＋</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </li>
                <li>
                    <label class="cart-checkbox-label">
                        <input class="cart-input" data-id="2" type="checkbox" name="checkbox">
                        <i class="icon-no-selected"></i>
                        <i class="icon-selected2"></i>
                    </label>
                    <div class="cart-list-info">
                        <div class="cart-img">
                            <img src="images/commodity.jpg">
                        </div>
                        <div class="cart-list-main">
                            <p class="cart-list-name">[现榨现喝 轻便携带]Midea/...</p>
                            <p class="cart-list-specifications">1L 白色</p>
                            <div class="cart-list-bottom">
                                <p class="cart-list-price">¥<span class="price" >54.00</span></p>
                                <div class="popup-cart-number-choice">
                                    <p class="popup-cart-number-choice-btn reduce" data-id="2">－</p>
                                    <input value="5" data-price="54"  data-min="1"  data-max="10" readonly class="popup-cart-number-choice-input" id="num_2">
                                    <p class="popup-cart-number-choice-btn plus" data-id="2">＋</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </li>
                
            </ul>
            <p class="cart-list-tip">福州城区范围内，订单满¥60起配送，免运费。</p>
        </div>
        <div class="cart-settlement">
            <div class="cart-settlement-choice">
                <label class="cart-checkbox-label">
                    <input class="allCheckbox" type="checkbox" name="allCheckbox">
                    <i class="icon-no-selected pull-left"></i>
                    <i class="icon-selected2 pull-left"></i>
                    <p class="span">全选</p>
                </label>
                
            </div>
            <!-- cart-settlement-confirm -->
            <button class="cart-btn cart-settlement-difference" data-min="60">删除</button>
        </div>
    </div>
</div>
</body>
<script type="text/javascript" src="js/zepto.min.js"></script>
<script type="text/javascript" src="js/touch.js"></script>
<script type="text/javascript" src="plugins/layer_mobile/layer.js"></script>
<script type="text/javascript" src="plugins/swiper/swiper.min.js"></script>
<script type="text/javascript">
    $(document).ready(function() {

        //统计
        function allPrice(){
            var allPrice = 0;

            $(".cart-input").each(function(key, item) {

                if($(item).is(':checked')){
                    var id = $(item).attr('data-id');

                    var input = $("#num_" + id);

                    var value = input.val();

                    var price = input.attr('data-price');

                    allPrice += value * price;

                }
            });

            allPrice = allPrice.toFixed(2);
            
            $(".all-price").html(allPrice);

            var value = $('.cart-btn').attr('data-min');

            var difference = value - allPrice;

            if(difference > 0){

                $('.cart-btn').addClass('cart-settlement-difference').removeClass('cart-settlement-confirm').html('还差￥'+difference+'起送');

            }else{

                $('.cart-btn').addClass('cart-settlement-confirm').removeClass('cart-settlement-difference').html('去结算');

            }
            
        }

        //单选框选择
        $(".cart-input").on('click', function() {

            var num = 0;
            $(".cart-input").each(function(key, item) {

                if(!$(item).is(':checked')){
                    num++;
                }
            });

            if(num != 0){
                $(".allCheckbox").prop('checked', false);
            }else{

                $(".allCheckbox").prop('checked', true);
            }

            allPrice();
        })

        //全选选择
        $(".allCheckbox").click(function(){

            if($(".allCheckbox").is(':checked')){

                $(".cart-input").prop('checked', true);
            }else{

                $(".cart-input").prop('checked', false);
            }

            allPrice();
        });

        //减号
        $(".reduce").on('click', function(){
            var id = $(this).attr('data-id');

            var input = $("#num_" + id);

            var min = input.attr('data-min');

            var value = input.val();
            value--;
            value = value >= min ? value : min;

            input.val(value);

            allPrice();
        })

        //加号
        $(".plus").on('click', function(){
            var id = $(this).attr('data-id');

            var input = $("#num_" + id);

            var max = input.attr('data-max');

            var value = input.val();
            value++;
            value = value <= max ? value : max;

            input.val(value);
            allPrice();

        });
    });

</script>
</html>